extends basic.jade

mixin renderToc(items)
	#toc
		| Chapters:
		ul
			- each item in items
				li
					a(href="##{item.id}")= item.text
					if (item.children.length > 0)
						+renderToc(item.children)

block banner
	if banner
		style.
			#nav { background-image: url(#{banner}) }
			
block topmatter
	h2= title
	p #{summary} &nbsp; #{wordCount} words; reading time #{readingTime}.
	p 
		a(href='#{altlink}') first posted here
		|  on #{published}
	if tags
		- var tagl = []
		- for (i = 0; i < tags.length; i++)
			- tag = tags[i].name
			- urltag = tags[i].slug
			- tagl.push("<a href='../tags/" + urltag + ".html'>" + tag + "</a>")
		- var tagstring = tagl.join(', ')
		.info 
			| tags:&nbsp;
			!= tagstring
				
block content
	#story_box
		#storybody
			!= contents
		if toc
			+renderToc(toc)

block footer
	hr
	p: small: a(href='../acknowledgments.html') Credits, acknowledgments, and disclaimers.
